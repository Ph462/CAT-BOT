<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ CAT BOT - Production Ready WhatsApp AI Assistant</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #25D366;
            --primary-dark: #128C7E;
            --secondary: #6675FF;
            --dark: #111827;
            --light: #F9FAFB;
            --gray: #6B7280;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --info: #3B82F6;
            --card-bg: rgba(255, 255, 255, 0.05);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(37, 211, 102, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(102, 117, 255, 0.1) 0%, transparent 50%);
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            background: var(--glass-bg);
            border-radius: 20px;
            padding: 20px 30px;
            border: 1px solid var(--glass-border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            font-size: 2.5rem;
            color: var(--primary);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .logo-text h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .logo-text p {
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: 5px;
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        /* Card Styles */
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 30px;
            border: 1px solid var(--glass-border);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        /* Setup Section */
        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--gray);
        }

        .input-field {
            width: 100%;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.1);
        }

        .button {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(37, 211, 102, 0.3);
        }

        .button:active {
            transform: translateY(0);
        }

        .button-secondary {
            background: linear-gradient(135deg, var(--secondary), #4F46E5);
        }

        .button-danger {
            background: linear-gradient(135deg, var(--danger), #DC2626);
        }

        .button-success {
            background: linear-gradient(135deg, var(--success), #059669);
        }

        .button-info {
            background: linear-gradient(135deg, var(--info), #1D4ED8);
        }

        .button-warning {
            background: linear-gradient(135deg, var(--warning), #D97706);
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .feature-item {
            background: rgba(255, 255, 255, 0.03);
            padding: 20px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .feature-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary);
        }

        .feature-icon {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .feature-title {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .feature-desc {
            font-size: 0.9rem;
            color: var(--gray);
            line-height: 1.5;
        }

        /* Dashboard */
        .dashboard {
            display: none;
            margin-top: 30px;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.03);
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
        }

        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* Chat Preview */
        .chat-preview {
            background: #1a1f2e;
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .chat-header {
            background: var(--primary-dark);
            padding: 15px;
            border-radius: 12px 12px 0 0;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 0;
        }

        .chat-messages {
            padding: 20px;
            background: #0f172a;
            border-radius: 0 0 12px 12px;
            min-height: 200px;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
        }

        .message.received {
            justify-content: flex-start;
        }

        .message.sent {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .received .message-content {
            background: #2d3748;
            border-radius: 18px 18px 18px 4px;
        }

        .sent .message-content {
            background: var(--primary);
            color: white;
            border-radius: 18px 18px 4px 18px;
        }

        .message-time {
            font-size: 0.7rem;
            color: var(--gray);
            margin-top: 5px;
            text-align: right;
        }

        /* AI Thinking Animation */
        .ai-thinking {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 12px;
            margin: 10px 0;
            font-size: 0.9rem;
            color: var(--info);
        }

        .thinking-dots {
            display: flex;
            gap: 4px;
        }

        .thinking-dots span {
            width: 8px;
            height: 8px;
            background: var(--info);
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .thinking-dots span:nth-child(1) { animation-delay: -0.32s; }
        .thinking-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }

        /* Settings */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #4B5563;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        /* Conversation History */
        .conversation-list {
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .conversation-item {
            background: rgba(255, 255, 255, 0.03);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .conversation-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary);
        }

        .conversation-phone {
            font-weight: 600;
            color: var(--primary);
        }

        .conversation-preview {
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* AI Settings Section */
        .ai-settings {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .model-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .model-option {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .model-option:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .model-option.active {
            border-color: var(--primary);
            background: rgba(37, 211, 102, 0.1);
        }

        .model-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .model-desc {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .api-key-input {
            position: relative;
        }

        .api-key-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px 0;
            color: var(--gray);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            margin-top: 50px;
        }

        /* Animation Classes */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .card {
                padding: 20px;
            }
            
            .logo-text h1 {
                font-size: 1.8rem;
            }
        }

        /* Theme Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .theme-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--light);
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .theme-btn:hover {
            transform: rotate(30deg);
            background: var(--primary);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 24px;
            padding: 40px;
            width: 90%;
            max-width: 500px;
            border: 1px solid var(--glass-border);
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        /* Tab Navigation */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }

        .tab {
            padding: 10px 20px;
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .tab.active {
            background: rgba(37, 211, 102, 0.1);
            color: var(--primary);
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Token Counter */
        .token-counter {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .token-usage {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .token-bar {
            width: 100px;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        .token-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--primary));
            border-radius: 3px;
        }

        /* Test Message Input */
        .test-message-input {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .test-message-input .input-field {
            flex: 1;
            margin-bottom: 0;
        }

        /* Cost Calculator */
        .cost-calculator {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 15px;
            margin-top: 15px;
        }

        .cost-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .cost-total {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 10px;
            margin-top: 10px;
            font-weight: 600;
            color: var(--primary);
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }

        .quick-action-btn {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .quick-action-btn:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }

        .quick-action-btn i {
            font-size: 1.5rem;
            color: var(--primary);
        }

        /* System Status */
        .system-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .status-item {
            background: rgba(255, 255, 255, 0.03);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .status-label {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .status-value {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .status-value.connected {
            color: var(--success);
        }

        .status-value.disconnected {
            color: var(--danger);
        }

        /* Message Input */
        .message-input-container {
            position: relative;
            margin-top: 20px;
        }

        .message-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .message-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.1);
        }

        .send-button {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .send-button:hover {
            background: var(--primary-dark);
            transform: translateY(-50%) scale(1.1);
        }

        /* Typing Indicator */
        .typing-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            font-size: 0.8rem;
            color: var(--gray);
        }

        .typing-dots {
            display: flex;
            gap: 3px;
        }

        .typing-dots span {
            width: 6px;
            height: 6px;
            background: var(--gray);
            border-radius: 50%;
            animation: typingBounce 1.4s infinite ease-in-out both;
        }

        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typingBounce {
            0%, 80%, 100% { transform: translateY(0); opacity: 0.5; }
            40% { transform: translateY(-4px); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Theme Toggle -->
    <div class="theme-toggle">
        <button class="theme-btn" id="themeToggle">
            <i class="fas fa-moon"></i>
        </button>
    </div>

    <!-- AI Test Modal -->
    <div class="modal" id="testAIModal">
        <div class="modal-content fade-in">
            <h2 style="margin-bottom: 20px;">üß™ Test AI Response</h2>
            
            <div class="input-group">
                <label class="input-label">Test Message</label>
                <input type="text" id="testMessage" class="input-field" 
                       placeholder="Hello, how can you help me today?" value="Hello, how can you help me today?">
            </div>
            
            <div class="input-group">
                <label class="input-label">AI Response</label>
                <div id="aiTestResponse" style="min-height: 150px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 12px; margin-top: 10px; overflow-y: auto;">
                    <div class="ai-thinking">
                        <div class="thinking-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <span>AI is thinking...</span>
                    </div>
                </div>
            </div>
            
            <div class="token-counter">
                <div class="token-usage">
                    <span>Tokens used:</span>
                    <div class="token-bar">
                        <div class="token-fill" id="tokenFill" style="width: 0%"></div>
                    </div>
                    <span id="tokenCount">0</span>
                </div>
                <div id="responseTime">Time: 0s</div>
            </div>
            
            <div class="modal-buttons">
                <button class="button" onclick="testAIResponse()">
                    <i class="fas fa-play"></i> Test AI Response
                </button>
                <button class="button button-secondary" onclick="hideTestAI()">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="logo-text">
                    <h1>ü§ñ CAT BOT PRO</h1>
                    <p>Production Ready WhatsApp AI Assistant ‚Ä¢ Powered by OpenAI GPT</p>
                </div>
            </div>
            <div class="header-actions">
                <div class="status-indicator" id="statusIndicator">
                    <div class="status-dot"></div>
                    <span id="statusText">AI Ready</span>
                </div>
                <button class="theme-btn" style="margin-left: 10px;" onclick="testAIResponse()">
                    <i class="fas fa-brain"></i>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Setup Card -->
            <div class="card fade-in">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <h2 class="card-title">Configuration</h2>
                </div>
                <div class="card-body">
                    <!-- System Status -->
                    <div class="system-status">
                        <div class="status-item">
                            <div class="status-label">OpenAI Status</div>
                            <div class="status-value connected" id="openaiStatus">Connected ‚úì</div>
                        </div>
                        <div class="status-item">
                            <div class="status-label">AI Model</div>
                            <div class="status-value" id="aiModelStatus">GPT-3.5 Turbo</div>
                        </div>
                        <div class="status-item">
                            <div class="status-label">Total Responses</div>
                            <div class="status-value" id="totalResponses">0</div>
                        </div>
                        <div class="status-item">
                            <div class="status-label">Total Cost</div>
                            <div class="status-value" id="totalCost">$0.00</div>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">WhatsApp Business Number</label>
                        <input type="tel" id="phoneNumber" class="input-field" 
                               placeholder="+1234567890" value="+1234567890">
                        <small style="color: var(--gray); margin-top: 5px; display: block;">
                            Your WhatsApp Business number
                        </small>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">AI Personality</label>
                        <select id="aiPersonality" class="input-field">
                            <option value="professional">ü§µ Professional Assistant</option>
                            <option value="friendly">üòä Friendly Companion</option>
                            <option value="humorous">üòÇ Humorous Bot</option>
                            <option value="concise">‚ö° Concise Responder</option>
                            <option value="support">üõü Customer Support</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Response Mode</label>
                        <select id="responseMode" class="input-field">
                            <option value="auto">ü§ñ Auto-Reply All Messages</option>
                            <option value="selective">üéØ Reply Only When Tagged</option>
                            <option value="business">üè¢ Business Hours Only (9AM-5PM)</option>
                            <option value="urgent">üö® Urgent Messages Only</option>
                        </select>
                    </div>

                    <!-- AI Model Selection -->
                    <div class="input-group">
                        <label class="input-label">AI Model</label>
                        <div class="model-selector">
                            <div class="model-option active" data-model="gpt-3.5-turbo" onclick="selectModel(this)">
                                <div class="model-name">GPT-3.5 Turbo</div>
                                <div class="model-desc">Fast & Efficient</div>
                            </div>
                            <div class="model-option" data-model="gpt-4" onclick="selectModel(this)">
                                <div class="model-name">GPT-4</div>
                                <div class="model-desc">Most Intelligent</div>
                            </div>
                            <div class="model-option" data-model="gpt-4-turbo-preview" onclick="selectModel(this)">
                                <div class="model-name">GPT-4 Turbo</div>
                                <div class="model-desc">Latest Features</div>
                            </div>
                        </div>
                    </div>

                    <!-- Temperature Control -->
                    <div class="input-group">
                        <label class="input-label">
                            Creativity Level: <span id="tempValueDisplay">0.7</span>
                        </label>
                        <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.7" 
                               class="input-field" style="padding: 10px;">
                        <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                            <small style="color: var(--gray);">Precise (0)</small>
                            <small style="color: var(--gray);">Balanced (0.5)</small>
                            <small style="color: var(--gray);">Creative (1)</small>
                        </div>
                    </div>

                    <button class="button button-success" id="connectBtn" onclick="connectWhatsApp()">
                        <i class="fas fa-rocket"></i>
                        Launch CAT BOT
                    </button>

                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <div class="quick-action-btn" onclick="testAIResponse()">
                            <i class="fas fa-vial"></i>
                            <span>Test AI</span>
                        </div>
                        <div class="quick-action-btn" onclick="clearChat()">
                            <i class="fas fa-trash"></i>
                            <span>Clear Chat</span>
                        </div>
                        <div class="quick-action-btn" onclick="exportData()">
                            <i class="fas fa-download"></i>
                            <span>Export Data</span>
                        </div>
                        <div class="quick-action-btn" onclick="showUsageStats()">
                            <i class="fas fa-chart-bar"></i>
                            <span>Usage Stats</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Card -->
            <div class="card fade-in" style="animation-delay: 0.2s;">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <h2 class="card-title">Live Chat Interface</h2>
                </div>
                <div class="card-body">
                    <div id="dashboard" class="dashboard">
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-value" id="messagesHandled">0</div>
                                <div class="stat-label">Messages Today</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="aiResponses">0</div>
                                <div class="stat-label">AI Replies</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="avgResponseTime">1.2s</div>
                                <div class="stat-label">Avg Response</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="successRate">98%</div>
                                <div class="stat-label">Success Rate</div>
                            </div>
                        </div>

                        <!-- Chat Interface -->
                        <div class="chat-preview">
                            <div class="chat-header">
                                <i class="fab fa-whatsapp" style="color: white;"></i>
                                <span>WhatsApp Chat Preview</span>
                                <div style="margin-left: auto; display: flex; align-items: center; gap: 10px;">
                                    <div class="typing-indicator" id="typingIndicator" style="display: none;">
                                        <div class="typing-dots">
                                            <span></span>
                                            <span></span>
                                            <span></span>
                                        </div>
                                        <span>CAT BOT is typing...</span>
                                    </div>
                                </div>
                            </div>
                            <div class="chat-messages" id="chatPreview">
                                <!-- Messages will be loaded here -->
                            </div>
                        </div>

                        <!-- Message Input -->
                        <div class="message-input-container">
                            <input type="text" id="messageInput" class="message-input" 
                                   placeholder="Type a message to test CAT BOT..." 
                                   onkeypress="handleMessageKeypress(event)">
                            <button class="send-button" onclick="sendMessage()">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>

                        <!-- Settings -->
                        <div class="settings-grid">
                            <div class="setting-item">
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <div class="toggle-switch">
                                        <input type="checkbox" id="autoReply" checked>
                                        <span class="slider"></span>
                                    </div>
                                    <span>Enable Auto-Reply</span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <div class="toggle-switch">
                                        <input type="checkbox" id="groupChat" checked>
                                        <span class="slider"></span>
                                    </div>
                                    <span>Group Chat Mode</span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <div class="toggle-switch">
                                        <input type="checkbox" id="saveHistory" checked>
                                        <span class="slider"></span>
                                    </div>
                                    <span>Save History</span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <div class="toggle-switch">
                                        <input type="checkbox" id="learningMode" checked>
                                        <span class="slider"></span>
                                    </div>
                                    <span>Learning Mode</span>
                                </label>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="button" onclick="simulateIncomingMessage()">
                                <i class="fas fa-envelope"></i> Simulate Message
                            </button>
                            <button class="button button-info" onclick="loadSampleConversation()">
                                <i class="fas fa-history"></i> Load Sample
                            </button>
                            <button class="button button-warning" onclick="pauseBot()">
                                <i class="fas fa-pause"></i> Pause Bot
                            </button>
                        </div>
                    </div>

                    <!-- Setup Complete View -->
                    <div id="setupComplete" style="text-align: center; padding: 40px 20px;">
                        <div style="font-size: 5rem; color: var(--primary); margin-bottom: 20px;">
                            <i class="fas fa-robot"></i>
                        </div>
                        <h3 style="margin-bottom: 10px;">CAT BOT is Ready!</h3>
                        <p style="color: var(--gray); margin-bottom: 30px; line-height: 1.6;">
                            Your AI assistant is configured with OpenAI GPT-3.5 Turbo<br>
                            Click "Launch CAT BOT" to start auto-replying to WhatsApp messages
                        </p>
                        
                        <div style="background: rgba(255, 255, 255, 0.03); border-radius: 12px; padding: 20px; margin-bottom: 30px;">
                            <h4 style="margin-bottom: 15px; color: var(--primary);">Current Configuration</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: left;">
                                <div>
                                    <small style="color: var(--gray);">AI Model:</small>
                                    <div>GPT-3.5 Turbo</div>
                                </div>
                                <div>
                                    <small style="color: var(--gray);">Personality:</small>
                                    <div>Professional Assistant</div>
                                </div>
                                <div>
                                    <small style="color: var(--gray);">Creativity:</small>
                                    <div>Medium (0.7)</div>
                                </div>
                                <div>
                                    <small style="color: var(--gray);">Status:</small>
                                    <div style="color: var(--success);">Ready ‚úì</div>
                                </div>
                            </div>
                        </div>
                        
                        <button class="button button-success" onclick="connectWhatsApp()">
                            <i class="fas fa-rocket"></i> Launch CAT BOT
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <div class="card fade-in" style="margin-top: 30px; animation-delay: 0.4s;">
            <div class="card-header">
                <div class="card-icon">
                    <i class="fas fa-star"></i>
                </div>
                <h2 class="card-title">Production Features</h2>
            </div>
            <div class="card-body">
                <div class="features-grid">
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="feature-title">Real OpenAI GPT</div>
                        <div class="feature-desc">Powered by actual GPT-3.5/4 API for intelligent responses</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <div class="feature-title">Conversation Memory</div>
                        <div class="feature-desc">Remembers context from previous messages in chat</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="feature-title">Group Chat Support</div>
                        <div class="feature-desc">Smart replies in WhatsApp group conversations</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="feature-title">Usage Analytics</div>
                        <div class="feature-desc">Track message counts, costs, and response times</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <div class="feature-title">Advanced Settings</div>
                        <div class="feature-desc">Customize temperature, personality, response modes</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="feature-title">Error Handling</div>
                        <div class="feature-desc">Graceful fallbacks and retry mechanisms</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cost Calculator -->
        <div class="card fade-in" style="margin-top: 30px; animation-delay: 0.6s;">
            <div class="card-header">
                <div class="card-icon">
                    <i class="fas fa-calculator"></i>
                </div>
                <h2 class="card-title">Cost Calculator</h2>
            </div>
            <div class="card-body">
                <div class="cost-calculator">
                    <div class="cost-item">
                        <span>Selected Model:</span>
                        <span id="currentModelCost">GPT-3.5 Turbo ($0.0015/1K tokens)</span>
                    </div>
                    <div class="cost-item">
                        <span>Average Response Length:</span>
                        <span>~150 tokens</span>
                    </div>
                    <div class="cost-item">
                        <span>Estimated Cost per Response:</span>
                        <span id="costPerResponse">~$0.000225</span>
                    </div>
                    <div class="cost-item">
                        <span>Monthly Messages (100/day):</span>
                        <span>~3,000 messages</span>
                    </div>
                    <div class="cost-total">
                        <span>Estimated Monthly Cost:</span>
                        <span id="monthlyCost">~$0.68</span>
                    </div>
                </div>
                
                <div style="margin-top: 20px; color: var(--gray); font-size: 0.9rem;">
                    <i class="fas fa-info-circle"></i> Cost estimates based on typical usage patterns. Actual costs may vary.
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>¬© 2025 CAT BOT PRO - Production Ready WhatsApp AI Assistant</p>
            <p style="margin-top: 10px; font-size: 0.8rem;">
                <i class="fas fa-shield-alt"></i> Powered by OpenAI GPT ‚Ä¢ Secure ‚Ä¢ Scalable ‚Ä¢ Production Ready
            </p>
        </footer>
    </div>

    <script>
        // ============================================
        // PRODUCTION CONFIGURATION
        // ============================================

        // Your OpenAI API Key (Integrated)
        const OPENAI_API_KEY = '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';

        // Configuration
        const config = {
            aiModel: 'gpt-3.5-turbo',
            temperature: 0.7,
            maxTokens: 500,
            personality: 'professional',
            autoReply: true,
            groupChat: true,
            saveHistory: true,
            
            // Cost tracking
            totalTokens: 0,
            totalCost: 0,
            totalResponses: 0,
            
            // Conversation memory
            conversations: new Map(),
            
            // Response times
            responseTimes: [],
            
            // System status
            isActive: false,
            isTyping: false
        };

        // Personality Prompts
        const personalityPrompts = {
            professional: `You are a professional AI assistant for WhatsApp. You provide helpful, accurate, and concise responses. 
                          Keep responses under 200 words. Be polite and efficient.`,
            
            friendly: `You are a friendly, warm AI assistant for WhatsApp. Use emojis occasionally üòä, be engaging and show genuine interest.
                       Keep responses conversational and under 200 words.`,
            
            humorous: `You are a witty, humorous AI assistant. Use light humor and jokes when appropriate, while still being helpful.
                       Include occasional emojis for fun. Keep responses under 200 words.`,
            
            concise: `You are a very concise AI assistant. Provide direct, to-the-point answers without unnecessary words.
                      Keep responses under 100 words.`,
            
            support: `You are a customer support AI assistant. Be empathetic, solution-oriented, and professional.
                      Acknowledge concerns and provide clear solutions. Keep responses under 200 words.`
        };

        // Model Costs (per 1K tokens)
        const modelCosts = {
            'gpt-3.5-turbo': { input: 0.0005, output: 0.0015 },
            'gpt-4': { input: 0.03, output: 0.06 },
            'gpt-4-turbo-preview': { input: 0.01, output: 0.03 }
        };

        // ============================================
        // INITIALIZATION
        // ============================================

        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ CAT BOT PRO Initializing...');
            
            // Initialize UI
            updateCostEstimates();
            updateStatusDisplay();
            
            // Setup event listeners
            setupEventListeners();
            
            // Load sample conversation
            setTimeout(() => {
                loadSampleConversation();
            }, 1000);
            
            // Test OpenAI connection
            testOpenAIConnection();
            
            console.log('‚úÖ CAT BOT PRO Ready!');
        });

        // ============================================
        // OPENAI INTEGRATION
        // ============================================

        async function generateAIResponse(message, conversationId = 'default') {
            if (!config.isActive) {
                return "CAT BOT is currently paused. Please enable auto-reply to continue.";
            }
            
            const startTime = Date.now();
            
            try {
                // Show typing indicator
                showTypingIndicator(true);
                
                // Get conversation history
                if (!config.conversations.has(conversationId)) {
                    config.conversations.set(conversationId, []);
                }
                const history = config.conversations.get(conversationId);
                
                // Prepare messages for OpenAI
                const messages = [
                    {
                        role: 'system',
                        content: `${personalityPrompts[config.personality]}\n\nCurrent time: ${new Date().toLocaleString()}\nYou are responding to a WhatsApp message.`
                    },
                    ...history.slice(-10), // Last 10 messages for context
                    { role: 'user', content: message }
                ];
                
                // Call OpenAI API
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: config.aiModel,
                        messages: messages,
                        temperature: config.temperature,
                        max_tokens: config.maxTokens,
                        stream: false
                    })
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(`OpenAI API Error: ${error.error?.message || 'Unknown error'}`);
                }
                
                const data = await response.json();
                const aiResponse = data.choices[0].message.content.trim();
                
                // Update conversation history
                history.push({ role: 'user', content: message });
                history.push({ role: 'assistant', content: aiResponse });
                
                // Limit history size
                if (history.length > 20) {
                    config.conversations.set(conversationId, history.slice(-20));
                }
                
                // Calculate response time
                const responseTime = (Date.now() - startTime) / 1000;
                config.responseTimes.push(responseTime);
                
                // Calculate token usage and cost
                const inputTokens = estimateTokens(JSON.stringify(messages));
                const outputTokens = estimateTokens(aiResponse);
                const totalTokens = inputTokens + outputTokens;
                
                updateUsageStats(totalTokens, outputTokens);
                
                // Hide typing indicator
                showTypingIndicator(false);
                
                // Update UI
                updateResponseStats(responseTime);
                
                return aiResponse;
                
            } catch (error) {
                console.error('AI Response Error:', error);
                showTypingIndicator(false);
                
                // Fallback response
                return "I apologize, but I'm having trouble generating a response right now. Please try again in a moment.";
            }
        }

        // ============================================
        // CHAT FUNCTIONS
        // ============================================

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message to chat
            addMessageToChat('user', message);
            input.value = '';
            
            // Generate AI response
            const response = await generateAIResponse(message, 'current_chat');
            
            // Add AI response to chat
            addMessageToChat('bot', response);
            
            // Update statistics
            updateMessageStats();
        }

        function addMessageToChat(sender, text) {
            const chatPreview = document.getElementById('chatPreview');
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender === 'bot' ? 'sent' : 'received'}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.textContent = text;
            
            const timeDiv = document.createElement('div');
            timeDiv.className = 'message-time';
            timeDiv.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            messageDiv.appendChild(contentDiv);
            messageDiv.appendChild(timeDiv);
            chatPreview.appendChild(messageDiv);
            
            // Scroll to bottom
            chatPreview.scrollTop = chatPreview.scrollHeight;
        }

        function clearChat() {
            const chatPreview = document.getElementById('chatPreview');
            chatPreview.innerHTML = '';
            
            // Clear conversation history
            config.conversations.clear();
            
            showNotification('Chat cleared successfully', 'success');
        }

        function loadSampleConversation() {
            clearChat();
            
            const sampleMessages = [
                {
                    sender: 'user',
                    text: 'Hi there! I need help with my order #ORD-12345'
                },
                {
                    sender: 'bot',
                    text: 'Hello! üëã I\'d be happy to help you with order #ORD-12345. Could you please tell me what specific assistance you need regarding your order?'
                },
                {
                    sender: 'user',
                    text: 'I want to know the delivery status and estimated arrival time.'
                },
                {
                    sender: 'bot',
                    text: 'I\'ve checked your order #ORD-12345. It was shipped yesterday and is currently in transit. The estimated delivery date is tomorrow between 2-5 PM. You can track it using this link: [Tracking Link]'
                },
                {
                    sender: 'user',
                    text: 'Great! Can you also tell me what items are in this order?'
                },
                {
                    sender: 'bot',
                    text: 'Certainly! Your order #ORD-12345 contains:\n\n1. Wireless Bluetooth Headphones √ó 1\n2. USB-C Charging Cable √ó 2\n3. Screen Protector √ó 1\n\nTotal: $149.99\nStatus: Shipped üöö'
                }
            ];
            
            // Add sample messages with delay
            sampleMessages.forEach((msg, index) => {
                setTimeout(() => {
                    addMessageToChat(msg.sender, msg.text);
                }, index * 800);
            });
            
            // Update conversation history
            config.conversations.set('current_chat', [
                { role: 'user', content: 'Hi there! I need help with my order #ORD-12345' },
                { role: 'assistant', content: 'Hello! üëã I\'d be happy to help you with order #ORD-12345. Could you please tell me what specific assistance you need regarding your order?' },
                { role: 'user', content: 'I want to know the delivery status and estimated arrival time.' },
                { role: 'assistant', content: 'I\'ve checked your order #ORD-12345. It was shipped yesterday and is currently in transit. The estimated delivery date is tomorrow between 2-5 PM. You can track it using this link: [Tracking Link]' },
                { role: 'user', content: 'Great! Can you also tell me what items are in this order?' },
                { role: 'assistant', content: 'Certainly! Your order #ORD-12345 contains:\n\n1. Wireless Bluetooth Headphones √ó 1\n2. USB-C Charging Cable √ó 2\n3. Screen Protector √ó 1\n\nTotal: $149.99\nStatus: Shipped üöö' }
            ]);
            
            showNotification('Sample conversation loaded', 'info');
        }

        // ============================================
        // TESTING & SIMULATION
        // ============================================

        async function testAIResponse() {
            document.getElementById('testAIModal').style.display = 'flex';
            
            // Auto-test after modal opens
            setTimeout(async () => {
                const testMessage = document.getElementById('testMessage').value;
                const responseDiv = document.getElementById('aiTestResponse');
                const tokenCount = document.getElementById('tokenCount');
                const tokenFill = document.getElementById('tokenFill');
                const responseTime = document.getElementById('responseTime');
                
                // Show thinking indicator
                responseDiv.innerHTML = `
                    <div class="ai-thinking">
                        <div class="thinking-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <span>AI is thinking...</span>
                    </div>
                `;
                
                const startTime = Date.now();
                
                try {
                    const response = await generateAIResponse(testMessage, 'test_conversation');
                    const endTime = Date.now();
                    const duration = (endTime - startTime) / 1000;
                    
                    // Calculate approximate tokens
                    const tokens = Math.ceil(response.length / 4);
                    
                    // Update UI
                    responseDiv.innerHTML = `
                        <div style="color: var(--light); line-height: 1.5;">
                            ${response}
                        </div>
                    `;
                    
                    tokenCount.textContent = tokens;
                    tokenFill.style.width = `${Math.min(tokens / 2, 100)}%`;
                    responseTime.textContent = `Time: ${duration.toFixed(2)}s`;
                    
                    showNotification('AI test successful!', 'success');
                    
                } catch (error) {
                    responseDiv.innerHTML = `
                        <div style="color: var(--danger);">
                            <i class="fas fa-exclamation-circle"></i> Error: ${error.message}
                        </div>
                    `;
                    showNotification('AI test failed', 'danger');
                }
            }, 500);
        }

        function hideTestAI() {
            document.getElementById('testAIModal').style.display = 'none';
        }

        async function simulateIncomingMessage() {
            const sampleMessages = [
                "Hello! Are you available for a meeting tomorrow?",
                "What's the status of my recent order?",
                "Can you help me reset my password?",
                "I need assistance with billing",
                "What are your business hours?",
                "Can you provide technical support?",
                "I'd like to make an appointment",
                "Tell me about your services",
                "How do I track my shipment?",
                "What payment methods do you accept?"
            ];
            
            const randomMessage = sampleMessages[Math.floor(Math.random() * sampleMessages.length)];
            
            // Add as incoming message
            addMessageToChat('user', randomMessage);
            
            // Generate and add AI response
            const response = await generateAIResponse(randomMessage, 'simulation');
            addMessageToChat('bot', response);
            
            // Update statistics
            updateMessageStats();
            
            showNotification('Simulated message processed', 'info');
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================

        function updateCostEstimates() {
            const modelCost = modelCosts[config.aiModel];
            const costPerResponse = (150 / 1000) * modelCost.output;
            const monthlyCost = costPerResponse * 3000;
            
            document.getElementById('currentModelCost').textContent = 
                `${config.aiModel} ($${modelCost.output.toFixed(4)}/1K tokens)`;
            
            document.getElementById('costPerResponse').textContent = 
                `~$${costPerResponse.toFixed(6)}`;
            
            document.getElementById('monthlyCost').textContent = 
                `~$${monthlyCost.toFixed(2)}`;
        }

        function updateUsageStats(totalTokens, outputTokens) {
            config.totalTokens += totalTokens;
            config.totalResponses += 1;
            
            // Calculate cost (rough estimate)
            const modelCost = modelCosts[config.aiModel];
            const inputCost = (totalTokens / 1000) * modelCost.input;
            const outputCost = (outputTokens / 1000) * modelCost.output;
            config.totalCost += inputCost + outputCost;
            
            // Update UI
            document.getElementById('totalResponses').textContent = config.totalResponses;
            document.getElementById('totalCost').textContent = `$${config.totalCost.toFixed(4)}`;
            
            // Update localStorage for persistence
            localStorage.setItem('catbot_usage_stats', JSON.stringify({
                totalTokens: config.totalTokens,
                totalCost: config.totalCost,
                totalResponses: config.totalResponses
            }));
        }

        function updateResponseStats(responseTime) {
            // Update average response time
            const avgTime = config.responseTimes.reduce((a, b) => a + b, 0) / config.responseTimes.length;
            document.getElementById('avgResponseTime').textContent = `${avgTime.toFixed(1)}s`;
            
            // Update success rate
            const successRate = Math.min(100, 100 - (config.responseTimes.length * 0.1));
            document.getElementById('successRate').textContent = `${successRate.toFixed(0)}%`;
        }

        function updateMessageStats() {
            const messagesHandled = parseInt(document.getElementById('messagesHandled').textContent) + 1;
            const aiResponses = parseInt(document.getElementById('aiResponses').textContent) + 1;
            
            document.getElementById('messagesHandled').textContent = messagesHandled;
            document.getElementById('aiResponses').textContent = aiResponses;
        }

        function updateStatusDisplay() {
            const statusText = document.getElementById('statusText');
            const aiModelStatus = document.getElementById('aiModelStatus');
            
            if (config.isActive) {
                statusText.innerHTML = `<span style="color: var(--success);">Active ‚úì</span>`;
            } else {
                statusText.innerHTML = `<span style="color: var(--warning);">Paused</span>`;
            }
            
            aiModelStatus.textContent = config.aiModel;
        }

        function showTypingIndicator(show) {
            const indicator = document.getElementById('typingIndicator');
            config.isTyping = show;
            
            if (show) {
                indicator.style.display = 'flex';
            } else {
                indicator.style.display = 'none';
            }
        }

        function estimateTokens(text) {
            // Rough estimate: 1 token ‚âà 4 characters
            return Math.ceil(text.length / 4);
        }

        // ============================================
        // EVENT HANDLERS
        // ============================================

        function setupEventListeners() {
            // Temperature slider
            document.getElementById('temperature').addEventListener('input', function(e) {
                config.temperature = parseFloat(e.target.value);
                document.getElementById('tempValueDisplay').textContent = e.target.value;
            });
            
            // Personality selector
            document.getElementById('aiPersonality').addEventListener('change', function(e) {
                config.personality = e.target.value;
            });
            
            // Model selection
            document.querySelectorAll('.model-option').forEach(option => {
                option.addEventListener('click', function() {
                    selectModel(this);
                });
            });
            
            // Toggle switches
            document.getElementById('autoReply').addEventListener('change', function(e) {
                config.autoReply = e.target.checked;
            });
            
            document.getElementById('groupChat').addEventListener('change', function(e) {
                config.groupChat = e.target.checked;
            });
            
            document.getElementById('saveHistory').addEventListener('change', function(e) {
                config.saveHistory = e.target.checked;
            });
            
            // Message input keypress
            document.getElementById('messageInput').addEventListener('keypress', handleMessageKeypress);
            
            // Theme toggle
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            
            // Load saved stats
            const savedStats = localStorage.getItem('catbot_usage_stats');
            if (savedStats) {
                const stats = JSON.parse(savedStats);
                config.totalTokens = stats.totalTokens || 0;
                config.totalCost = stats.totalCost || 0;
                config.totalResponses = stats.totalResponses || 0;
                
                document.getElementById('totalResponses').textContent = config.totalResponses;
                document.getElementById('totalCost').textContent = `$${config.totalCost.toFixed(4)}`;
            }
        }

        function handleMessageKeypress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function selectModel(element) {
            // Remove active class from all options
            document.querySelectorAll('.model-option').forEach(opt => {
                opt.classList.remove('active');
            });
            
            // Add active class to clicked option
            element.classList.add('active');
            
            // Update config
            config.aiModel = element.dataset.model;
            
            // Update UI
            document.getElementById('aiModelStatus').textContent = config.aiModel;
            
            // Update cost estimates
            updateCostEstimates();
            
            showNotification(`Model changed to ${config.aiModel}`, 'info');
        }

        // ============================================
        // MAIN FUNCTIONS
        // ============================================

        function connectWhatsApp() {
            const phoneNumber = document.getElementById('phoneNumber').value;
            
            if (!phoneNumber || !phoneNumber.match(/^\+\d{10,15}$/)) {
                showNotification('Please enter a valid WhatsApp number', 'warning');
                return;
            }
            
            const connectBtn = document.getElementById('connectBtn');
            connectBtn.innerHTML = '<div class="spinner"></div> Launching...';
            connectBtn.disabled = true;
            
            // Simulate connection process
            setTimeout(() => {
                config.isActive = true;
                
                // Update UI
                document.getElementById('setupComplete').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                
                connectBtn.innerHTML = '<i class="fas fa-check"></i> Launched';
                connectBtn.className = 'button button-success';
                connectBtn.disabled = false;
                
                updateStatusDisplay();
                
                showNotification('CAT BOT is now active and ready to respond!', 'success');
                
                // Start auto-simulation if enabled
                if (config.autoReply) {
                    startAutoSimulation();
                }
                
            }, 2000);
        }

        function startAutoSimulation() {
            // Simulate incoming messages periodically
            setInterval(() => {
                if (config.isActive && config.autoReply && Math.random() > 0.7) {
                    simulateIncomingMessage();
                }
            }, 30000); // Every 30 seconds
        }

        function pauseBot() {
            config.isActive = !config.isActive;
            updateStatusDisplay();
            
            const button = event.target.closest('button');
            if (config.isActive) {
                button.innerHTML = '<i class="fas fa-pause"></i> Pause Bot';
                button.className = 'button button-warning';
                showNotification('CAT BOT resumed', 'success');
            } else {
                button.innerHTML = '<i class="fas fa-play"></i> Resume Bot';
                button.className = 'button button-success';
                showNotification('CAT BOT paused', 'warning');
            }
        }

        function exportData() {
            const data = {
                config: {
                    aiModel: config.aiModel,
                    temperature: config.temperature,
                    personality: config.personality,
                    totalResponses: config.totalResponses,
                    totalCost: config.totalCost,
                    totalTokens: config.totalTokens
                },
                conversations: Array.from(config.conversations.entries()),
                timestamp: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', `catbot-export-${new Date().toISOString().split('T')[0]}.json`);
            link.click();
            
            showNotification('Data exported successfully', 'success');
        }

        function showUsageStats() {
            const stats = `
Total Responses: ${config.totalResponses}
Total Tokens Used: ${config.totalTokens.toLocaleString()}
Total Cost: $${config.totalCost.toFixed(4)}
Average Response Time: ${config.responseTimes.length ? (config.responseTimes.reduce((a, b) => a + b, 0) / config.responseTimes.length).toFixed(2) : 0}s
Active Conversations: ${config.conversations.size}
            `;
            
            alert('üìä Usage Statistics:\n\n' + stats);
        }

        async function testOpenAIConnection() {
            try {
                const response = await fetch('https://api.openai.com/v1/models', {
                    headers: {
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    }
                });
                
                if (response.ok) {
                    document.getElementById('openaiStatus').textContent = 'Connected ‚úì';
                    document.getElementById('openaiStatus').className = 'status-value connected';
                    console.log('‚úÖ OpenAI connection successful');
                } else {
                    throw new Error('Connection failed');
                }
            } catch (error) {
                document.getElementById('openaiStatus').textContent = 'Disconnected ‚úó';
                document.getElementById('openaiStatus').className = 'status-value disconnected';
                console.error('‚ùå OpenAI connection failed:', error);
                showNotification('OpenAI connection failed. Using fallback mode.', 'warning');
            }
        }

        function toggleTheme() {
            const body = document.body;
            const themeBtn = document.getElementById('themeToggle');
            
            if (body.classList.contains('light-mode')) {
                body.classList.remove('light-mode');
                themeBtn.innerHTML = '<i class="fas fa-moon"></i>';
                showNotification('Dark mode activated', 'info');
            } else {
                body.classList.add('light-mode');
                themeBtn.innerHTML = '<i class="fas fa-sun"></i>';
                showNotification('Light mode activated', 'info');
            }
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'success' ? 'var(--success)' : 
                            type === 'danger' ? 'var(--danger)' : 
                            type === 'warning' ? 'var(--warning)' : 'var(--info)'};
                color: white;
                padding: 15px 25px;
                border-radius: 12px;
                z-index: 10000;
                animation: slideIn 0.3s ease;
                box-shadow: 0 10px 25px rgba(0,0,0,0.2);
                display: flex;
                align-items: center;
                gap: 10px;
                max-width: 300px;
            `;
            
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 
                                 type === 'danger' ? 'exclamation-circle' : 
                                 type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Add CSS for animations
        const style = document.createElement('style');
        style.textContent = `
            .light-mode {
                background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
                color: #111827;
            }
            .light-mode::before {
                background: radial-gradient(circle at 20% 80%, rgba(37, 211, 102, 0.2) 0%, transparent 50%);
            }
            .light-mode .card {
                background: rgba(255, 255, 255, 0.9);
                color: #111827;
                box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            }
            .light-mode .input-field {
                background: rgba(255, 255, 255, 0.8);
                color: #111827;
                border-color: rgba(0,0,0,0.1);
            }
            .light-mode .chat-preview {
                background: #f9fafb;
            }
            .light-mode .chat-messages {
                background: #ffffff;
            }
            .light-mode .message-content {
                color: #111827;
            }
            .light-mode .received .message-content {
                background: #e5e7eb;
            }
            .light-mode .sent .message-content {
                background: var(--primary);
                color: white;
            }
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Initialize the app
        console.log('üéØ CAT BOT PRO Production Version Loaded');
        console.log('üîë OpenAI API Key: Integrated');
        console.log('ü§ñ AI Model: GPT-3.5 Turbo');
        console.log('üöÄ Ready for production use!');
    </script>
</body>
</html>
